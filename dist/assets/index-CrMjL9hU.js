import{s as j}from"./index-BraZoT5L.js";import"./index-CrBVI4KK.js";import{o as W,s as A,h as q}from"./schemas-DgDhmXQR.js";import{J,r as v,L as Z,M as ee,c as b,o as p,a,e as C,j as w,w as d,b as s,y as i,N as e,A as B,F as se,P as V,R as m,n as te}from"./index-C-7RJgkn.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as L,s as le,a as U}from"./index-CPPwAHJ5.js";import{b as M}from"./index-CUnwFEp1.js";import{a as K}from"./index-C3KlkN14.js";import{s as I}from"./index-DF9WDu2i.js";import{s as z}from"./index-CA8W0Dso.js";import{s as Y}from"./index-DUTZYAen.js";import{r as ae,u as oe,d as ie}from"./helpers-Dl54-pCf.js";import{s as ne,a as re,b as Q,c as de,d as X}from"./index-DmMaV04l.js";import"./index-BI2ldBAY.js";import"./index-B9rXqS8S.js";import"./index-DQfmIj7h.js";import"./index-md5hE0pG.js";import"./index-C9Yn04yt.js";const ce={class:"flex items-center gap-8 py-4"},ue={class:"flex items-center gap-1"},pe={class:"text-sm font-medium"},me={class:"flex items-center gap-1"},ve={class:"text-sm font-medium"},fe={class:"flex flex-col gap-1 col-span-1"},_e={class:"text-sm font-medium"},he={class:"flex flex-col gap-1 col-span-1"},xe={class:"text-sm font-medium"},ge={class:"flex flex-col gap-1 col-span-1"},ye={class:"text-sm font-medium"},be={class:"flex flex-col gap-1 col-span-3"},we={class:"text-sm font-medium"},ke={class:"flex flex-col gap-1 col-span-1"},$e={class:"text-sm font-medium"},Ae={class:"flex flex-col gap-1 col-span-1"},Ne={class:"text-sm font-medium"},Ve={class:"flex flex-col gap-1 col-span-3"},Ce={class:"text-sm font-medium"},Ie={class:"flex items-center text-sm"},ze={class:"capitalize"},Ee={class:"flex items-center text-sm mt-2"},Te={class:"capitalize"},Se={class:"flex items-center text-sm"},Re={__name:"AddressConvert",setup(G){const{t:l}=J(),f=v([]),g=v([]),h=v([]),x=v("oldToNew"),k=v(!1),_=v(!1),$=v(null),y=v(null),N=()=>{$.value=null,y.value=null,_.value=!1},D=async()=>{try{const r=await V.get("/connector/viettelpost/provinces");r.data.success?f.value=r.data.data.data:m.error(r.data.message||"Lỗi khi lấy tỉnh/thành phố")}catch(r){m.error("Lỗi khi lấy tỉnh/thành phố"),console.error(r)}},O=async r=>{N();const o=f.value.find(t=>t.PROVINCE_NAME===r)?.PROVINCE_ID;if(!o){m.error("Không tìm thấy Id tỉnh");return}try{const t=await V.get("/connector/viettelpost/districts",{params:{provinceId:o}});t.data.success?g.value=t.data.data.data:m.error(t.data.message||"Lỗi khi lấy quận/huyện")}catch(t){m.error("Lỗi khi lấy quận/huyện"),console.error(t)}},P=async r=>{N();const o=g.value.find(t=>t.DISTRICT_NAME===r)?.DISTRICT_ID;if(!o){m.error("Không tìm thấy Id quận");return}try{const t=await V.get("/connector/viettelpost/wards",{params:{districtId:o}});t.data.success?h.value=t.data.data.data:m.error(t.data.message||"Lỗi khi lấy phường/xã")}catch(t){m.error("Lỗi khi lấy phường/xã"),console.error(t)}},F=async r=>{N();const o=f.value.find(t=>t.PROVINCE_NAME===r)?.PROVINCE_ID;if(!o){m.error("Không tìm thấy Id tỉnh");return}try{const t=await V.get("/connector/viettelpost/wards-new",{params:{provinceId:o}});t.data.success?h.value=t.data.data.data:m.error(t.data.message||"Lỗi khi lấy phường/xã")}catch(t){m.error("Lỗi khi lấy phường/xã"),console.error(t)}},u=W({province:A().min(1),district:A().min(1),ward:A().min(1),address:A().min(1)}),n=W({province:A().min(1),ward:A().min(1),address:A().min(1)}),c=Z(()=>x.value==="oldToNew"?q(u):q(n)),E=async r=>{if(!r.valid){m.error("Vui lòng nhập đầy đủ thông tin");return}k.value=!0;let o="";x.value==="oldToNew"?o=`${r.values.address}, ${r.values.ward}, ${r.values.district}, ${r.values.province}`:o=`${r.values.address}, ${r.values.ward}, ${r.values.province}`;try{const t=await V.post("/connector/viettelpost/checking-address",{address:o});t.data.success&&(y.value=t.data.data.reference.formattedAddress,$.value=o),_.value=!0,k.value=!1}catch(t){console.error(t),k.value=!1,_.value=!0}};return ee(()=>{D()}),(r,o)=>(p(),b(se,null,[a(e(z),{class:"w-full mt-4"},{content:d(()=>[s("div",null,[s("h2",null,i(e(l)("convertMethod")),1),s("div",ce,[s("div",ue,[a(e(L),{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=t=>x.value=t),value:"oldToNew",size:"small"},null,8,["modelValue"]),s("label",pe,i(e(l)("oldToNew")),1)]),s("div",me,[a(e(L),{modelValue:x.value,"onUpdate:modelValue":o[1]||(o[1]=t=>x.value=t),value:"newToOld",size:"small"},null,8,["modelValue"]),s("label",ve,i(e(l)("newToOld")),1)])])]),x.value==="oldToNew"?(p(),C(e(j),{key:0,initialValues:{province:"",district:"",ward:"",address:""},resolver:c.value,onSubmit:E,class:"grid grid-cols-3 gap-x-2 gap-y-4"},{default:d(t=>[s("div",fe,[s("label",_e,i(e(l)("province")),1),a(e(M),{name:"province",onChange:T=>O(t.province.value),options:f.value,optionLabel:"PROVINCE_NAME",optionValue:"PROVINCE_NAME",size:"small",filter:""},null,8,["onChange","options"])]),s("div",he,[s("label",xe,i(e(l)("district")),1),a(e(M),{name:"district",onChange:T=>P(t.district.value),options:g.value,optionLabel:"DISTRICT_NAME",optionValue:"DISTRICT_NAME",size:"small",filter:""},null,8,["onChange","options"])]),s("div",ge,[s("label",ye,i(e(l)("ward")),1),a(e(M),{name:"ward",options:h.value,optionLabel:"WARDS_NAME",optionValue:"WARDS_NAME",size:"small",filter:""},null,8,["options"])]),s("div",be,[s("label",we,i(e(l)("address")),1),a(e(K),{name:"address",size:"small"})]),a(e(I),{type:"submit",label:e(l)("convert"),icon:"pi pi-check",loading:k.value,size:"small"},null,8,["label","loading"])]),_:1},8,["resolver"])):w("",!0),x.value==="newToOld"?(p(),C(e(j),{key:1,initialValues:{province:"",ward:"",address:""},resolver:c.value,onSubmit:E,class:"grid grid-cols-2 gap-x-2 gap-y-4"},{default:d(t=>[s("div",ke,[s("label",$e,i(e(l)("province")),1),a(e(M),{name:"province",onChange:T=>F(t.province.value),options:f.value,optionLabel:"PROVINCE_NAME",optionValue:"PROVINCE_NAME",size:"small",filter:""},null,8,["onChange","options"])]),s("div",Ae,[s("label",Ne,i(e(l)("ward")),1),a(e(M),{name:"ward",options:h.value,optionLabel:"WARDS_NAME",optionValue:"WARDS_NAME",size:"small",filter:""},null,8,["options"])]),s("div",Ve,[s("label",Ce,i(e(l)("address")),1),a(e(K),{name:"address",size:"small"})]),a(e(I),{type:"submit",label:e(l)("convert"),icon:"pi pi-check",loading:k.value,size:"small"},null,8,["label","loading"])]),_:1},8,["resolver"])):w("",!0)]),_:1}),y.value&&_.value?(p(),C(e(z),{key:0,class:"mt-4 p-4 bg-green-200 result-card-success"},{header:d(()=>[...o[2]||(o[2]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-check-circle text-green-900"}),s("h2",{class:"text-green-900 font-bold text-xl"},"Kết quả")],-1)])]),content:d(()=>[s("div",Ie,[o[3]||(o[3]=s("span",{class:"font-bold block w-32"},"Địa chỉ gốc:",-1)),s("span",ze,i($.value),1)]),s("div",Ee,[o[4]||(o[4]=s("span",{class:"font-bold block w-32"},"Địa chỉ chuyển đổi:",-1)),s("span",Te,i(y.value),1)])]),_:1})):w("",!0),!y.value&&_.value?(p(),C(e(z),{key:1,class:"mt-4 p-4 result-card-failure"},{header:d(()=>[...o[5]||(o[5]=[s("div",{class:"flex items-center gap-2"},[s("i",{class:"pi pi-times-circle text-red-900"}),s("h2",{class:"text-red-900 font-bold text-xl"},"Kết quả")],-1)])]),content:d(()=>[s("div",Se,[a(e(Y),{severity:"error",icon:"pi pi-ban",size:"small"},{default:d(()=>[B(i(e(l)("errorHappened")),1)]),_:1})])]),_:1})):w("",!0)],64))}},Me=H(Re,[["__scopeId","data-v-57ce0cbd"]]),Le={class:"flex items-center gap-8 py-4"},De={class:"flex items-center gap-1"},Oe={for:"",class:"text-sm text-color font-medium"},Pe={class:"flex items-center gap-1"},Fe={for:"",class:"text-sm text-color font-medium"},Ue={key:0},je={class:"flex items-end gap-1 w-full"},We={class:"flex flex-col gap-1 flex-1"},qe={class:"text-sm font-medium"},Be={class:"flex items-center gap-2"},Ke={class:"text-green-900 font-bold text-xl"},Je={class:"flex items-center text-sm mt-2"},He={class:"capitalize"},Ge={class:"flex items-center gap-2"},Qe={class:"text-red-900 font-bold text-xl"},Xe={class:"flex items-center text-sm"},Ye={key:1},Ze={class:"flex items-end gap-4 justify-between"},es={class:"flex items-end"},ss={key:0,class:"flex items-center gap-1 text-sm"},ts={class:"flex items-center gap-4 justify-end"},ls={key:0,class:"mt-2"},as={class:"text-sm"},os={key:0},is={key:0,class:"pi pi-times text-red-500 mr-2 mt-1",size:"small"},ns={key:1,class:"pi pi-check-circle text-green-700 mr-2 mt-1",size:"small"},rs={key:1},ds={class:"py-4 flex justify-end items-center"},cs={__name:"AddressVerify",setup(G){const{t:l}=J(),f=v(!1),g=q(W({address:A().min(1)})),h=v("single"),x=v(null),k=v(""),_=v(null),$=v([]),y=v(null),N=v(!1),D=async u=>{if(!u.valid){m.error(l("enterAllInfoNeeded"));return}f.value=!0;try{const n=await V.post("/connector/viettelpost/checking-address",{address:u.values.address});n.data.success?(y.value=n.data.data?.formattedAddress,N.value=!0):m.error(n.data.message||l("addressInvalid"))}catch(n){m.error(l("addressInvalid")),console.error(n)}finally{f.value=!1}},O=u=>{if(_.value=u.target.files[0],k.value=u.target.files[0].name,!_.value)return;const n=new FileReader;n.onload=c=>{const E=new Uint8Array(c.target.result),r=ae(E,{type:"array"}),o=r.SheetNames[0],t=r.Sheets[o];oe.sheet_to_json(t).map((S,R)=>{S.address&&$.value.push({index:R+1,address:S.address,verifiedAddress:""})})},n.readAsArrayBuffer(_.value)},P=async()=>{if(!_.value){m.error(l("selectFile"));return}f.value=!0;const u=2,n=ie($.value,u);for(let c=0;c<n.length;c++){const r=n[c].map((t,T)=>{const S=c*u+T;return V.post("/connector/viettelpost/checking-address",{address:t.address}).then(R=>({idx:S,res:R})).catch(R=>{throw{idx:S,err:R}})});(await Promise.allSettled(r)).forEach(t=>{t.status==="fulfilled"?$.value[t.value.idx].verifiedAddress=t.value.res.data?.data?.formattedAddress||l("error"):console.log(t.value)})}f.value=!1},F=()=>{const u=document.createElement("a");u.href="/docs/addresses.xlsx",u.download="addresses.xlsx",document.body.appendChild(u),u.click(),document.body.removeChild(u)};return(u,n)=>(p(),C(e(z),{class:"w-full mt-4"},{content:d(()=>[s("div",Le,[s("div",De,[a(e(L),{modelValue:h.value,"onUpdate:modelValue":n[0]||(n[0]=c=>h.value=c),value:"single",size:"small"},null,8,["modelValue"]),s("label",Oe,i(e(l)("singleAddress")),1)]),s("div",Pe,[a(e(L),{modelValue:h.value,"onUpdate:modelValue":n[1]||(n[1]=c=>h.value=c),value:"batch",size:"small"},null,8,["modelValue"]),s("label",Fe,i(e(l)("batchAddress")),1)])]),h.value==="single"?(p(),b("div",Ue,[a(e(j),{initialValues:{address:""},resolver:e(g),onSubmit:D},{default:d(c=>[s("div",je,[s("div",We,[s("label",qe,i(e(l)("address")),1),a(e(K),{name:"address",class:"w-full",size:"small"})]),a(e(I),{type:"submit",label:e(l)("verify"),icon:"pi pi-check",loading:f.value,size:"small"},null,8,["label","loading"])])]),_:1},8,["resolver"]),y.value&&N.value?(p(),C(e(z),{key:0,class:"mt-4 p-4 bg-green-200 result-card-success"},{header:d(()=>[s("div",Be,[n[3]||(n[3]=s("i",{class:"pi pi-check-circle text-green-900"},null,-1)),s("h2",Ke,i(e(l)("result")),1)])]),content:d(()=>[s("div",Je,[s("span",He,i(y.value),1)])]),_:1})):w("",!0),!y.value&&N.value?(p(),C(e(z),{key:1,class:"mt-4 p-4 result-card-failure"},{header:d(()=>[s("div",Ge,[n[4]||(n[4]=s("i",{class:"pi pi-times-circle text-red-900"},null,-1)),s("h2",Qe,i(e(l)("result")),1)])]),content:d(()=>[s("div",Xe,[a(e(Y),{severity:"error",icon:"pi pi-ban",size:"small"},{default:d(()=>[B(i(e(l)("errorHappened")),1)]),_:1})])]),_:1})):w("",!0)])):w("",!0),h.value==="batch"?(p(),b("div",Ye,[s("div",Ze,[s("div",es,[k.value?(p(),b("span",ss,[n[5]||(n[5]=s("i",{class:"pi pi-file text-primary"},null,-1)),B(i(k.value),1)])):w("",!0)]),s("div",ts,[s("input",{ref_key:"fileChooser",ref:x,type:"file",name:"file",accept:".xlsx, .xls",id:"fileChooser",hidden:"",onChange:O},null,544),a(e(I),{type:"button",label:e(l)("upload"),size:"small",icon:"pi pi-upload",onClick:n[2]||(n[2]=c=>x.value.click())},null,8,["label"]),a(e(I),{icon:"pi pi-download",label:e(l)("downloadTemplate"),variant:"outlined",severity:"info",size:"small",onClick:F},null,8,["label"])])]),_.value?(p(),b("div",ls,[a(e(le),{value:$.value,responsiveLayout:"scroll",showGridlines:""},{default:d(()=>[a(e(U),{field:"index",header:"STT",style:{"text-align":"center",padding:"1rem"}}),a(e(U),{field:"address",header:e(l)("address"),style:{width:"50%",padding:"1rem"}},{body:d(c=>[s("span",as,i(c.data.address),1)]),_:1},8,["header"]),a(e(U),{field:"verifiedAddress",header:e(l)("verifiedAddress"),style:{width:"50%",padding:"1rem"}},{body:d(c=>[c.data.verifiedAddress.length?(p(),b("div",os,[c.data.verifiedAddress==="Lỗi"?(p(),b("i",is)):(p(),b("i",ns)),s("span",{class:te(["text-sm text-color",[c.data.verifiedAddress==="Lỗi"?"text-red-500":"text-green-700"]])},i(c.data.verifiedAddress),3)])):(p(),b("div",rs))]),_:1},8,["header"])]),_:1},8,["value"]),s("div",ds,[a(e(I),{onClick:P,type:"button",label:e(l)("verify"),icon:"pi pi-check",loading:f.value,size:"small"},null,8,["label","loading"])])])):w("",!0)])):w("",!0)]),_:1}))}},us=H(cs,[["__scopeId","data-v-bdd75625"]]),ps={class:"h-full p-4 flex flex-col gap-2 overflow-auto"},ms={class:"flex flex-col gap-2"},vs={class:"text-2xl font-bold text-color"},fs={class:"text-muted-color text-sm"},_s={class:"flex item-center gap-2"},hs={class:"text-sm"},xs={class:"flex item-center gap-2"},gs={class:"text-sm"},ys={__name:"index",setup(G){const{t:l}=J();return(f,g)=>(p(),b("div",ps,[s("div",ms,[s("h1",vs,i(e(l)("addressUtil")),1),s("span",fs,i(e(l)("addressUtilDesc")),1)]),a(e(ne),{value:"1",class:"flex flex-1 my-tab"},{default:d(()=>[a(e(re),null,{default:d(()=>[a(e(Q),{value:"1"},{default:d(()=>[s("div",_s,[g[0]||(g[0]=s("i",{class:"pi pi-arrow-right-arrow-left mt-1"},null,-1)),s("span",hs,i(e(l)("addressConvert")),1)])]),_:1}),a(e(Q),{value:"2"},{default:d(()=>[s("div",xs,[g[1]||(g[1]=s("i",{class:"pi pi-map-marker mt-1"},null,-1)),s("span",gs,i(e(l)("addressVerify")),1)])]),_:1})]),_:1}),a(e(de),{class:"flex flex-1"},{default:d(()=>[a(e(X),{value:"1",class:"w-full"},{default:d(()=>[a(Me)]),_:1}),a(e(X),{value:"2",class:"w-full"},{default:d(()=>[a(us)]),_:1})]),_:1})]),_:1})]))}},Ps=H(ys,[["__scopeId","data-v-6dfd9b66"]]);export{Ps as default};
